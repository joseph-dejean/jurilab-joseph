{
  "rules": {
    "personalEvents": {
      "$uid": {
        ".read": "auth != null && auth.uid === $uid",
        ".write": "auth != null && auth.uid === $uid && root.child('users').child(auth.uid).child('disabled').val() !== true"
      }
    },
    "lawyers": {
      ".read": true,
      ".write": "auth != null && root.child('users').child(auth.uid).child('disabled').val() !== true && root.child('users').child(auth.uid).child('role').val() === 'ADMIN'",
      "$uid": {
        ".read": true,
        ".write": "auth != null && root.child('users').child(auth.uid).child('disabled').val() !== true && (auth.uid === $uid || root.child('users').child(auth.uid).child('role').val() === 'ADMIN')"
      }
    },
    "clients": {
      "$uid": {
        ".read": "auth != null && (auth.uid === $uid || root.child('users').child(auth.uid).child('role').val() === 'ADMIN')",
        ".write": "auth != null && (auth.uid === $uid || root.child('users').child(auth.uid).child('role').val() === 'ADMIN')"
      }
    },
    "tasks": {
      "$uid": {
        ".read": "auth != null && auth.uid === $uid && root.child('users').child(auth.uid).child('disabled').val() !== true",
        ".write": "auth != null && auth.uid === $uid && root.child('users').child(auth.uid).child('disabled').val() !== true"
      }
    },
    "users": {
      ".read": "auth != null && root.child('users').child(auth.uid).child('disabled').val() !== true && root.child('users').child(auth.uid).child('role').val() === 'ADMIN'",
      ".write": "auth != null && root.child('users').child(auth.uid).child('disabled').val() !== true && root.child('users').child(auth.uid).child('role').val() === 'ADMIN'",
      "$uid": {
        ".read": "auth != null && (auth.uid === $uid || root.child('users').child(auth.uid).child('role').val() === 'ADMIN')",
        ".write": "auth != null && ( (root.child('users').child(auth.uid).child('disabled').val() !== true && root.child('users').child(auth.uid).child('role').val() === 'ADMIN') || (auth.uid === $uid && root.child('users').child(auth.uid).child('disabled').val() !== true) )",
        ".validate": "root.child('users').child(auth.uid).child('role').val() === 'ADMIN' || (newData.hasChildren(['id','name','email','role']) && newData.child('id').val() === $uid && (auth.uid === $uid && ( (!data.exists() && (newData.child('role').val() === 'CLIENT' || newData.child('role').val() === 'LAWYER')) || (data.exists() && newData.child('role').val() === data.child('role').val()) ) && ( (!data.exists() && newData.child('disabled').val() !== true) || (data.exists() && newData.child('disabled').val() === data.child('disabled').val()) ) ))"
      }
    },
    "appointments": {
      ".read": "auth != null && (root.child('users').child(auth.uid).child('disabled').val() !== true || root.child('users').child(auth.uid).child('role').val() === 'ADMIN')",
      ".write": false,
      ".indexOn": [
        "clientId",
        "lawyerId"
      ],
      "$appointmentId": {
        ".read": "auth != null && (root.child('users').child(auth.uid).child('role').val() === 'ADMIN' || data.child('clientId').val() === auth.uid || data.child('lawyerId').val() === auth.uid)",
        ".write": "auth != null && root.child('users').child(auth.uid).child('disabled').val() !== true && (root.child('users').child(auth.uid).child('role').val() === 'ADMIN' || (!data.exists() && newData.child('clientId').val() === auth.uid) || (data.exists() && (data.child('clientId').val() === auth.uid || data.child('lawyerId').val() === auth.uid)))",
        ".validate": "root.child('users').child(auth.uid).child('role').val() === 'ADMIN' || newData.hasChildren(['id', 'lawyerId', 'clientId', 'date', 'status', 'type'])"
      }
    },
    "chatPermissions": {
      "$channelId": {
        ".read": "auth != null && (root.child('users').child(auth.uid).child('role').val() === 'ADMIN' || data.child('lawyerId').val() === auth.uid || data.child('clientId').val() === auth.uid || !data.exists())",
        ".write": "auth != null && root.child('users').child(auth.uid).child('disabled').val() !== true && (root.child('users').child(auth.uid).child('role').val() === 'ADMIN' || newData.child('lawyerId').val() === auth.uid || (data.exists() && data.child('lawyerId').val() === auth.uid))",
        "clientCanMessage": {
          ".read": "auth != null && (root.child('users').child(auth.uid).child('role').val() === 'ADMIN' || root.child('chatPermissions').child($channelId).child('lawyerId').val() === auth.uid || root.child('chatPermissions').child($channelId).child('clientId').val() === auth.uid || !root.child('chatPermissions').child($channelId).exists())",
          ".write": "auth != null && root.child('users').child(auth.uid).child('disabled').val() !== true && (root.child('users').child(auth.uid).child('role').val() === 'ADMIN' || root.child('chatPermissions').child($channelId).child('lawyerId').val() === auth.uid)"
        }
      }
    },
    "documents": {
      ".read": "auth != null",
      ".write": false,
      ".indexOn": [
        "lawyerId",
        "clientId",
        "uploadedBy"
      ],
      "$documentId": {
        ".read": "auth != null && (root.child('users').child(auth.uid).child('role').val() === 'ADMIN' || data.child('lawyerId').val() === auth.uid || (data.child('clientId').val() === auth.uid && data.child('sharedWithClient').val() === true))",
        ".write": "auth != null && root.child('users').child(auth.uid).child('disabled').val() !== true && (root.child('users').child(auth.uid).child('role').val() === 'ADMIN' || (!data.exists() || data.child('lawyerId').val() === auth.uid || data.child('uploadedBy').val() === auth.uid))",
        ".validate": "root.child('users').child(auth.uid).child('role').val() === 'ADMIN' || newData.hasChildren(['id', 'name', 'fileName', 'fileUrl', 'fileType', 'lawyerId', 'clientId', 'uploadedBy'])"
      }
    }
  }
}